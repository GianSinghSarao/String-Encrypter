<!DOCTYPE html>
<html>
  <head>
    <title>String Encrypter</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
    <style>
      body {
        display: block;
        position: relative;
        font-family: monospace;
        background-color: #708090;
        color: #808080;
      }
      input {
        background-color: #202020;
        color: #808080;
      }
      input[type="button"] {
        margin: 1em;
        display: inline-block; 
        width: 150px; 
        height: 24px; 
        color: #fff; 
        background: #203040;
      }
      input[type="button"]:hover {
        background: #102030;
      }
      textarea {
        background-color: #202020;
        color: #808080;
      }
      .password {
        width: 100%;
        display: block;
      }
      .password * {
        display: inline-block; 
        height: 1em; 
        font-size: 1em; 
        padding: 0; 
        margin: 0; 
        border: none;
      }
    </style>
  </head>
  <body>
    <HTA:APPLICATION applicationName="String Encrypter" version="0.8" maximizeButton="yes" scroll="no" icon="#"></HTA:APPLICATION>
    
    <span style="display: block; width: 600px; margin: 0 auto; padding: 0; text-align: center;">
      <span style="display: block; font-size: 2em; color: #000; width: 100%; ">
        String Encrypter
      </span>
      <textarea id="tamsg" cols="80" rows="15" style="display:block; width: 600px; height: auto; overflow: auto; margin: 0 auto;"></textarea>
      <input type="hidden" id="akey">
      <span class="password">
        <span style="width: 100px; color: #000;">Password:</span> 
        <input type="password" id="pass" style="width: 490px;">
      </span>
      <input type="button" value="Encrypt" onclick="Validate(Encrypt)"/>
      <input type="button" value="Decrypt" onclick="Validate(Decrypt)"/>
    </span>
    <script>
      window.onload = function () {
        var width = 700, height = 500;
        window.resizeTo(width, height);
      }
      var pass = document.getElementById('pass');
      var tamsg = document.getElementById('tamsg');
      var akey = document.getElementById('akey');
      function Validate(ID) {
        if (pass.value === "") {
          alert("You Have To Enter Your Password!");
        } else {
          if (tamsg.value === "") {
            alert("Enter The Text To Encrypt Or Decrypt!");
          } else {
            KEYS(ID);
          }
        }
      }
      function KEYS(ID) {
        var text = pass.value;
        var code = 0
        while (text !== "") {
          code += text.charCodeAt(0);
          text = text.slice(1);
        }
        code = code % 255;
        akey.value = code;
        ID();
      }
      function Encrypt () {
        var Alpha = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
        var text = tamsg.value;
        var code = "";
        var key = Number(akey.value);
        while (text !== "") {
          var cnum = text.charCodeAt(0);
          cnum = (cnum + key) % 255;
          num = cnum % 26;
          var count = 0;
          var tst = num;
          while (tst !== cnum) {
            tst += 26;
            count += 1
          }
          code = code + Alpha[num] + count;
          text = text.slice(1);
        }
        tamsg.value = code;
      }
      function Decrypt () {
        var Alpha = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
        var text = tamsg.value;
        var code = "";
        var key = Number(akey.value);
        while (text !== "") {
          var lttr = text.slice(0,2);
          var num = lttr.charCodeAt(0) - 65
          var chk = lttr.slice(1,2);
          var count = 0;
          while (count !== Number(chk)) {
            num += 26;
            count += 1; 
          }
          num -= key;
          while (num <= 0) {
            num += 255;
          }
          code = code + String.fromCharCode(num);
          text = text.slice(2);
        }
        tamsg.value = code;
      }
    </script>
  </body>
</html>