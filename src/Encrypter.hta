<!DOCTYPE html>
<html>
  <head>
    <title>String Encrypter</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
    <hta:application applicationname="String Encrypter" id="String Encrypter" version="0.8" maximizebutton="yes" scroll="no" icon="#"></hta:application>
    <style>
      td {
        color: Black;
      }
      caption {
        color: Black;
      }
      body {
        font-family: Arial;
        background-color: #708090;
        color: #808080;
      }
      input {
        background-color: #202020;
        color: #808080;
      }
      textarea {
        background-color: #202020;
        color: #808080;
      }
    </style>
  </head>
  <body>
    <input type="hidden" id="akey">
    <table align="center" width="400">
      <caption style="font-family: Book Antiqua; font-size:20">
        <hr color="black"><b>String Encrypter</b>
        <p>By Orange</p>
        <hr color="black">
      </caption>
      <tbody>
        <tr>
          <td align="center"><span title="Enter your Full message here!"><textarea id="tamsg" cols="80"
                rows="15"></textarea></span></td>
        </tr>
        <tr>
          <td color="black" style="font-family: Book Antiqua; font-size:18">
            <hr color="black">Password &nbsp;<span title="Enter your password here"><input type="password"
                id="pass"></span><span title="Click Here to Encrypt your Message"><input
                style="width: 170px; height: 23px; color: white; background: rgb(32, 48, 64); font-family: 'Book Antiqua';"
                type="button" value="Encrypt" id="btnenc" onclick="Validate(Encrypt)"
                onmouseover="btnenc.style.background='#102030'" onmouseout="btnenc.style.background='#203040'"></span>
            <span title="Click Here to Decrypt your Message"><input
                style="width: 170px; height: 23px; color: white; background: rgb(32, 48, 64); font-family: 'Book Antiqua'; font-size: 13px;"
                type="button" value="Decrypt" id="btndec" onclick="Validate(Decrypt)"
                onmouseover="btndec.style.background='#102030'" onmouseout="btndec.style.background='#203040'"></span>
          </td>
        </tr>
      </tbody>
    </table>
    </span>
    <script>
      window.onload = function () {
        var width = 700, height = 500;
        window.resizeTo(width, height);
      }
      var pass = document.getElementById('pass');
      var tamsg = document.getElementById('tamsg');
      var akey = document.getElementById('akey');
      function Validate(ID) {
        if (pass.value === "") {
          alert("You Have To Enter Your Password!");
        } else {
          if (tamsg.value === "") {
            alert("Enter The Text To Encrypt Or Decrypt!");
          } else {
            KEYS(ID);
          }
        }
      }
      function KEYS(ID) {
        var text = pass.value;
        var code = 0
        while (text !== "") {
          code += text.charCodeAt(0);
          text = text.slice(1);
        }
        code = code % 255;
        akey.value = code;
        ID();
      }
      function Encrypt () {
        var Alpha = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
        var text = tamsg.value;
        var code = "";
        var key = Number(akey.value);
        while (text !== "") {
          var cnum = text.charCodeAt(0);
          cnum = (cnum + key) % 255;
          num = cnum % 26;
          var count = 0;
          var tst = num;
          while (tst !== cnum) {
            tst += 26;
            count += 1
          }
          code = code + Alpha[num] + count;
          text = text.slice(1);
        }
        tamsg.value = code;
      }
      function Decrypt () {
        var Alpha = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
        var text = tamsg.value;
        var code = "";
        var key = Number(akey.value);
        while (text !== "") {
          var lttr = text.slice(0,2);
          var num = lttr.charCodeAt(0) - 65
          var chk = lttr.slice(1,2);
          var count = 0;
          while (count !== Number(chk)) {
            num += 26;
            count += 1; 
          }
          num -= key;
          while (num <= 0) {
            num += 255;
          }
          code = code + String.fromCharCode(num);
          text = text.slice(2);
        }
        tamsg.value = code;
      }
    </script>
  </body>
</html>